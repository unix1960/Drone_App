<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>运营报表 - 合伙人管理系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#1E40AF',
                        accent: '#06B6D4',
                        dark: '#1E293B',
                        light: '#F8FAFC',
                        'gray-medium': '#64748B',
                        'gray-light': '#E2E8F0',
                        'blue-primary': '#3B82F6',
                        'blue-secondary': '#1D4ED8',
                        'status-success': '#10B981',
                        'status-warning': '#F59E0B',
                        'status-danger': '#EF4444',
                    },
                    fontFamily: {
                        inter: ['Inter', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            }
            .touch-friendly {
                touch-action: manipulation;
                -webkit-tap-highlight-color: transparent;
            }
            .safe-area-bottom {
                padding-bottom: constant(safe-area-inset-bottom);
                padding-bottom: env(safe-area-inset-bottom);
            }
            .miniprogram-card {
                box-shadow: 0 2px 8px rgba(0,0,0,0.06);
                border-radius: 8px;
            }
            .chart-container {
                position: relative;
                height: 200px;
                width: 100%;
            }
        }
    </style>
</head>
<body class="font-inter bg-light text-dark antialiased touch-action-manipulation">
    <!-- 页面容器 -->
    <div class="min-h-screen w-full pb-24 safe-area-bottom">
        <!-- 头部导航 -->
        <header class="bg-white border-b border-gray-light sticky top-0 z-40">
            <div class="flex items-center justify-between h-14 px-4">
                <button onclick="navigateToPage('login.html')" class="flex items-center text-gray-medium touch-friendly">
                    <i class="fa fa-sign-out mr-1"></i>
                    <span class="text-sm">退出</span>
                </button>
                <h1 class="font-bold text-dark">运营报表</h1>
                <div class="flex items-center space-x-2">
                    <button id="exportBtn" class="text-gray-medium touch-friendly">
                        <i class="fa fa-download text-xl"></i>
                    </button>
                    <button id="dateRangeBtn" class="flex items-center text-gray-medium touch-friendly">
                        <i class="fa fa-calendar-o mr-1"></i>
                        <span class="text-sm">最近7天</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- 数据概览 -->
        <section class="p-4">
            <div class="miniprogram-card bg-white p-4">
                <h2 class="font-bold text-dark mb-4">数据概览</h2>
                <div class="grid grid-cols-2 gap-4">
                    <!-- 订单总数 -->
                    <div class="bg-blue-50 rounded-lg p-4">
                        <p class="text-gray-medium text-sm mb-1">订单总数</p>
                        <div class="flex items-baseline">
                            <span class="text-3xl font-bold mr-2">128</span>
                            <span class="text-xs text-status-success">+12%</span>
                        </div>
                    </div>
                    <!-- 总收益 -->
                    <div class="bg-green-50 rounded-lg p-4">
                        <p class="text-gray-medium text-sm mb-1">总收益</p>
                        <div class="flex items-baseline">
                            <span class="text-3xl font-bold mr-2">¥15,628</span>
                            <span class="text-xs text-status-success">+8.5%</span>
                        </div>
                    </div>
                    <!-- 拍摄成功率 -->
                    <div class="bg-purple-50 rounded-lg p-4">
                        <p class="text-gray-medium text-sm mb-1">拍摄成功率</p>
                        <div class="flex items-baseline">
                            <span class="text-3xl font-bold mr-2">96.2%</span>
                            <span class="text-xs text-status-success">+1.3%</span>
                        </div>
                    </div>
                    <!-- 设备使用率 -->
                    <div class="bg-amber-50 rounded-lg p-4">
                        <p class="text-gray-medium text-sm mb-1">设备使用率</p>
                        <div class="flex items-baseline">
                            <span class="text-3xl font-bold mr-2">78.5%</span>
                            <span class="text-xs text-status-warning">-2.1%</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 每日订单量统计 -->
        <section class="p-4">
            <div class="miniprogram-card bg-white p-4">
                <h2 class="font-bold text-dark mb-4">每日订单量统计</h2>
                <div class="chart-container">
                    <canvas id="ordersChart"></canvas>
                </div>
            </div>
        </section>

        <!-- 拍摄成功率分析 -->
        <section class="p-4">
            <div class="miniprogram-card bg-white p-4">
                <h2 class="font-bold text-dark mb-4">拍摄成功率分析</h2>
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="flex-1">
                        <div class="chart-container">
                            <canvas id="successRateChart"></canvas>
                        </div>
                    </div>
                    <div class="flex-1 space-y-4">
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium">成功订单</span>
                                <span class="text-sm font-medium">123单 (96.2%)</span>
                            </div>
                            <div class="w-full bg-gray-light rounded-full h-2">
                                <div class="bg-status-success rounded-full h-2 transition-all duration-500" style="width: 96.2%"></div>
                            </div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium">失败订单</span>
                                <span class="text-sm font-medium">5单 (3.8%)</span>
                            </div>
                            <div class="w-full bg-gray-light rounded-full h-2">
                                <div class="bg-status-danger rounded-full h-2 transition-all duration-500" style="width: 3.8%"></div>
                            </div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium">平均拍摄时长</span>
                                <span class="text-sm font-medium">12分钟/单</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 设备使用率统计 -->
        <section class="p-4">
            <div class="miniprogram-card bg-white p-4">
                <h2 class="font-bold text-dark mb-4">设备使用率统计</h2>
                <div class="chart-container">
                    <canvas id="deviceUsageChart"></canvas>
                </div>
                <div class="grid grid-cols-3 gap-4 mt-4">
                    <div class="bg-gray-50 p-3 rounded-lg text-center">
                        <p class="text-gray-medium text-xs mb-1">平均使用率</p>
                        <p class="text-lg font-bold">78.5%</p>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg text-center">
                        <p class="text-gray-medium text-xs mb-1">最高使用率</p>
                        <p class="text-lg font-bold">92.3%</p>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg text-center">
                        <p class="text-gray-medium text-xs mb-1">最低使用率</p>
                        <p class="text-lg font-bold">65.8%</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 收益数据展示 -->
        <section class="p-4">
            <div class="miniprogram-card bg-white p-4">
                <h2 class="font-bold text-dark mb-4">收益数据展示</h2>
                <div class="chart-container">
                    <canvas id="revenueChart"></canvas>
                </div>
                <div class="grid grid-cols-2 gap-4 mt-4">
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="text-gray-medium text-xs mb-1">日均收益</p>
                        <p class="text-2xl font-bold text-primary">¥2,232</p>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="text-gray-medium text-xs mb-1">单均收益</p>
                        <p class="text-2xl font-bold text-primary">¥122.1</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 日期范围选择弹窗 -->
        <div id="dateRangeModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 hidden">
            <div class="bg-white rounded-lg w-full max-w-md mx-4 overflow-hidden">
                <div class="p-5 border-b border-gray-light">
                    <h3 class="font-bold text-lg text-dark">选择日期范围</h3>
                </div>
                <div class="p-5 space-y-4">
                    <div class="space-y-2">
                        <button class="w-full p-3 border border-primary bg-primary/5 text-dark rounded-lg text-sm font-medium touch-friendly date-range-option active">
                            最近7天
                        </button>
                        <button class="w-full p-3 border border-gray-light text-dark rounded-lg text-sm font-medium touch-friendly date-range-option">
                            最近30天
                        </button>
                        <button class="w-full p-3 border border-gray-light text-dark rounded-lg text-sm font-medium touch-friendly date-range-option">
                            本月
                        </button>
                        <button class="w-full p-3 border border-gray-light text-dark rounded-lg text-sm font-medium touch-friendly date-range-option">
                            上月
                        </button>
                        <button class="w-full p-3 border border-gray-light text-dark rounded-lg text-sm font-medium touch-friendly date-range-option">
                            自定义日期
                        </button>
                    </div>
                    <div class="flex space-x-3">
                        <button id="cancelDateRangeBtn" class="flex-1 bg-gray-light text-gray-medium py-3 rounded-lg font-medium touch-friendly">
                            取消
                        </button>
                        <button id="confirmDateRangeBtn" class="flex-1 bg-primary text-white py-3 rounded-lg font-medium touch-friendly">
                            确定
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 底部导航栏 -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-light z-50 safe-area-bottom">
        <div class="flex justify-around items-center h-16">
            <div class="tab-item flex flex-col items-center justify-center text-gray-medium touch-friendly" data-page="order" onclick="location.href='order.html'">
                <i class="fa fa-list-alt text-lg mb-1"></i>
                <span class="text-xs">订单</span>
            </div>
            <div class="tab-item flex flex-col items-center justify-center text-gray-medium touch-friendly" data-page="device" onclick="location.href='device.html'">
                <i class="fa fa-cube text-lg mb-1"></i>
                <span class="text-xs">设备</span>
            </div>
            <div class="tab-item flex flex-col items-center justify-center text-primary touch-friendly active" data-page="report">
                <i class="fa fa-bar-chart text-lg mb-1"></i>
                <span class="text-xs">报表</span>
            </div>
            <div class="tab-item flex flex-col items-center justify-center text-gray-medium touch-friendly" data-page="profile" onclick="location.href='profile.html'">
                <i class="fa fa-user text-lg mb-1"></i>
                <span class="text-xs">我的</span>
            </div>
        </div>
    </nav>

    <!-- JavaScript交互代码 -->
    <script src="app.js"></script>
    <script>
        // 页面加载完成后初始化图表
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
        });

        // 初始化所有图表
        function initCharts() {
            // 每日订单量统计图表
            const ordersCtx = document.getElementById('ordersChart').getContext('2d');
            new Chart(ordersCtx, {
                type: 'bar',
                data: {
                    labels: ['6/10', '6/11', '6/12', '6/13', '6/14', '6/15', '6/16'],
                    datasets: [{
                        label: '订单数量',
                        data: [15, 18, 12, 22, 16, 21, 12],
                        backgroundColor: '#3B82F6',
                        borderRadius: 6,
                        barPercentage: 0.6,
                        categoryPercentage: 0.6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                display: true,
                                color: '#f1f5f9'
                            },
                            ticks: {
                                font: {
                                    size: 10
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });

            // 拍摄成功率分析图表
            const successRateCtx = document.getElementById('successRateChart').getContext('2d');
            new Chart(successRateCtx, {
                type: 'doughnut',
                data: {
                    labels: ['成功订单', '失败订单'],
                    datasets: [{
                        data: [96.2, 3.8],
                        backgroundColor: ['#10B981', '#EF4444'],
                        borderWidth: 0,
                        cutout: '70%'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.parsed}%`;
                                }
                            }
                        }
                    }
                }
            });

            // 设备使用率统计图表
            const deviceUsageCtx = document.getElementById('deviceUsageChart').getContext('2d');
            new Chart(deviceUsageCtx, {
                type: 'line',
                data: {
                    labels: ['6/10', '6/11', '6/12', '6/13', '6/14', '6/15', '6/16'],
                    datasets: [{
                        label: '设备使用率',
                        data: [82, 88, 75, 92, 80, 73, 65],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#F59E0B',
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                },
                                font: {
                                    size: 10
                                }
                            },
                            grid: {
                                display: true,
                                color: '#f1f5f9'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });

            // 收益数据展示图表
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            new Chart(revenueCtx, {
                type: 'bar',
                data: {
                    labels: ['6/10', '6/11', '6/12', '6/13', '6/14', '6/15', '6/16'],
                    datasets: [{
                        label: '日收益',
                        data: [1850, 2160, 1420, 2580, 1950, 2450, 1420],
                        backgroundColor: '#10B981',
                        borderRadius: 6,
                        barPercentage: 0.6,
                        categoryPercentage: 0.6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                display: true,
                                color: '#f1f5f9'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '¥' + value;
                                },
                                font: {
                                    size: 10
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });
        }

        // 日期范围选择按钮点击事件
        const dateRangeBtn = document.getElementById('dateRangeBtn');
        const dateRangeModal = document.getElementById('dateRangeModal');
        const cancelDateRangeBtn = document.getElementById('cancelDateRangeBtn');
        const confirmDateRangeBtn = document.getElementById('confirmDateRangeBtn');

        dateRangeBtn.addEventListener('click', () => {
            dateRangeModal.classList.remove('hidden');
        });

        cancelDateRangeBtn.addEventListener('click', () => {
            dateRangeModal.classList.add('hidden');
        });

        confirmDateRangeBtn.addEventListener('click', () => {
            // 获取选中的日期范围
            const selectedOption = document.querySelector('.date-range-option.active');
            if (selectedOption) {
                const dateRangeText = selectedOption.textContent.trim();
                dateRangeBtn.querySelector('span').textContent = dateRangeText;
                
                // 模拟加载数据
                showToast(`正在加载${dateRangeText}的数据...`);
                
                setTimeout(() => {
                    showToast(`数据已更新为${dateRangeText}`);
                    // 实际应用中应重新加载图表数据
                }, 1500);
            }
            
            dateRangeModal.classList.add('hidden');
        });

        // 日期范围选项点击事件
        const dateRangeOptions = document.querySelectorAll('.date-range-option');
        dateRangeOptions.forEach(option => {
            option.addEventListener('click', () => {
                dateRangeOptions.forEach(opt => {
                    opt.classList.remove('active', 'border-primary', 'bg-primary/5');
                    opt.classList.add('border-gray-light');
                });
                option.classList.add('active', 'border-primary', 'bg-primary/5');
                option.classList.remove('border-gray-light');
            });
        });

        // 点击弹窗外部关闭
        dateRangeModal.addEventListener('click', (e) => {
            if (e.target === dateRangeModal) {
                dateRangeModal.classList.add('hidden');
            }
        });

        // 导出按钮点击事件
        const exportBtn = document.getElementById('exportBtn');
        exportBtn.addEventListener('click', () => {
            showToast('正在导出报表...');
            
            // 模拟导出过程
            setTimeout(() => {
                showToast('报表导出成功');
            }, 1500);
        });
    </script>
</body>
</html>