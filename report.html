<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>数据报表 - 无人机自助打卡</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#1E40AF',
                        accent: '#06B6D4',
                        dark: '#1E293B',
                        light: '#F8FAFC',
                        'gray-medium': '#64748B',
                        'gray-light': '#E2E8F0',
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-light">
    <!-- 页面容器 -->
    <div class="min-h-screen pb-16">
        <!-- 顶部标题区域 -->
        <div class="bg-gradient-to-r from-primary to-accent p-4 text-white">
            <div class="container mx-auto">
                <h1 class="text-xl font-bold">数据报表</h1>
                <p class="text-sm opacity-90">查看运营数据和统计信息</p>
            </div>
        </div>

        <!-- 主要内容区域 -->
        <div class="container mx-auto px-4 py-4">
            <!-- 日期选择器 -->
            <div class="bg-white rounded-lg shadow-sm p-4 mb-4">
                <div class="flex justify-between items-center">
                    <div class="text-sm font-medium">数据周期</div>
                    <select id="dateRange" class="bg-gray-light/50 px-3 py-1 rounded-full text-sm">
                        <option value="today">今日</option>
                        <option value="week" selected>本周</option>
                        <option value="month">本月</option>
                        <option value="quarter">本季度</option>
                    </select>
                </div>
            </div>

            <!-- 收益概览 -->
            <div class="card-tech bg-white p-4 rounded-lg shadow-sm mb-4">
                <div class="flex justify-between items-center mb-3">
                    <h2 class="text-lg font-semibold">收益概览</h2>
                    <span class="tech-badge">本周</span>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="tech-border p-3 rounded-lg">
                        <div class="text-sm text-gray-medium">总收益</div>
                        <div class="text-2xl font-bold text-primary mt-1">¥8,560</div>
                        <div class="text-xs text-gray-medium mt-1">
                            <i class="fa fa-arrow-up text-success"></i> 较上周增长 12%
                        </div>
                    </div>
                    <div class="tech-border p-3 rounded-lg">
                        <div class="text-sm text-gray-medium">订单数</div>
                        <div class="text-2xl font-bold text-accent mt-1">76</div>
                        <div class="text-xs text-gray-medium mt-1">
                            <i class="fa fa-arrow-up text-success"></i> 较上周增长 8%
                        </div>
                    </div>
                </div>
            </div>

            <!-- 每日订单量统计 -->
            <div class="bg-white rounded-lg shadow-sm p-4 mb-4">
                <h3 class="text-lg font-semibold mb-3">每日订单量统计</h3>
                <div class="h-64">
                    <canvas id="orderChart"></canvas>
                </div>
            </div>

            <!-- 拍摄成功率分析 -->
            <div class="bg-white rounded-lg shadow-sm p-4 mb-4">
                <h3 class="text-lg font-semibold mb-3">拍摄成功率分析</h3>
                <div class="flex justify-center mb-3">
                    <div class="w-40 h-40">
                        <canvas id="successRateChart"></canvas>
                    </div>
                </div>
                <div class="grid grid-cols-3 gap-2 text-center">
                    <div>
                        <div class="text-sm text-gray-medium">成功</div>
                        <div class="text-lg font-bold text-success">92%</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-medium">失败</div>
                        <div class="text-lg font-bold text-danger">5%</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-medium">取消</div>
                        <div class="text-lg font-bold text-warning">3%</div>
                    </div>
                </div>
            </div>

            <!-- 设备使用率统计 -->
            <div class="bg-white rounded-lg shadow-sm p-4 mb-4">
                <h3 class="text-lg font-semibold mb-3">设备使用率统计</h3>
                <div class="space-y-3">
                    <div>
                        <div class="flex justify-between text-sm mb-1">
                            <span>大疆御3pro - DJI-M3P-001</span>
                            <span class="font-medium">85%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill bg-success" style="width: 85%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between text-sm mb-1">
                            <span>大疆御3pro - DJI-M3P-002</span>
                            <span class="font-medium">62%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill bg-primary" style="width: 62%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between text-sm mb-1">
                            <span>大疆御3pro - DJI-M3P-003</span>
                            <span class="font-medium">78%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill bg-primary" style="width: 78%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between text-sm mb-1">
                            <span>大疆御3pro - DJI-M3P-004</span>
                            <span class="font-medium">45%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill bg-accent" style="width: 45%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 景点热度排行 -->
            <div class="bg-white rounded-lg shadow-sm p-4 mb-4">
                <h3 class="text-lg font-semibold mb-3">景点热度排行</h3>
                <div class="space-y-3">
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center text-white font-bold text-sm flex-shrink-0 mr-3">1</div>
                        <div class="flex-1">
                            <div class="flex justify-between">
                                <span class="font-medium">涌泉寺</span>
                                <span class="text-primary font-medium">32 单</span>
                            </div>
                            <div class="progress-bar mt-1">
                                <div class="progress-bar-fill bg-primary" style="width: 100%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full bg-accent flex items-center justify-center text-white font-bold text-sm flex-shrink-0 mr-3">2</div>
                        <div class="flex-1">
                            <div class="flex justify-between">
                                <span class="font-medium">摩崖石刻</span>
                                <span class="text-primary font-medium">28 单</span>
                            </div>
                            <div class="progress-bar mt-1">
                                <div class="progress-bar-fill bg-accent" style="width: 87%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full bg-secondary flex items-center justify-center text-white font-bold text-sm flex-shrink-0 mr-3">3</div>
                        <div class="flex-1">
                            <div class="flex justify-between">
                                <span class="font-medium">登山古径</span>
                                <span class="text-primary font-medium">21 单</span>
                            </div>
                            <div class="progress-bar mt-1">
                                <div class="progress-bar-fill bg-secondary" style="width: 65%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full bg-gray-light flex items-center justify-center text-gray-medium font-bold text-sm flex-shrink-0 mr-3">4</div>
                        <div class="flex-1">
                            <div class="flex justify-between">
                                <span class="font-medium">屴崱峰</span>
                                <span class="text-primary font-medium">15 单</span>
                            </div>
                            <div class="progress-bar mt-1">
                                <div class="progress-bar-fill bg-gray-medium" style="width: 47%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full bg-gray-light flex items-center justify-center text-gray-medium font-bold text-sm flex-shrink-0 mr-3">5</div>
                        <div class="flex-1">
                            <div class="flex justify-between">
                                <span class="font-medium">回龙阁</span>
                                <span class="text-primary font-medium">12 单</span>
                            </div>
                            <div class="progress-bar mt-1">
                                <div class="progress-bar-fill bg-gray-medium" style="width: 37%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 导出报表 -->
            <div class="mt-4">
                <button id="exportReportBtn" class="btn btn-tech w-full">
                    <i class="fa fa-download mr-2"></i> 导出报表
                </button>
            </div>
        </div>

        <!-- 底部导航栏 -->
        <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-light z-40 safe-area-bottom">
            <div class="flex h-14">
                <a href="order.html" class="nav-item" data-page="order">
                    <i class="fa fa-list-alt text-lg mb-1"></i>
                    <span class="text-xs">订单</span>
                </a>
                <a href="device.html" class="nav-item" data-page="device">
                    <i class="fa fa-paper-plane text-lg mb-1"></i>
                    <span class="text-xs">设备</span>
                </a>
                <a href="report.html" class="nav-item active" data-page="report">
                    <i class="fa fa-bar-chart text-lg mb-1"></i>
                    <span class="text-xs">报表</span>
                </a>
                <a href="profile.html" class="nav-item" data-page="profile">
                    <i class="fa fa-user text-lg mb-1"></i>
                    <span class="text-xs">我的</span>
                </a>
            </div>
        </nav>
    </div>

    <!-- JavaScript -->
    <script src="app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化图表
            initCharts();
            
            // 日期范围选择
            const dateRange = document.getElementById('dateRange');
            dateRange.addEventListener('change', function() {
                // 更新图表数据
                updateChartsByDateRange(this.value);
            });
            
            // 导出报表
            const exportReportBtn = document.getElementById('exportReportBtn');
            exportReportBtn.addEventListener('click', function() {
                showLoading();
                
                setTimeout(() => {
                    hideLoading();
                    showToast('报表已导出到您的邮箱');
                }, 1500);
            });
        });
        
        // 初始化图表
        function initCharts() {
            // 订单量统计图表
            const orderCtx = document.getElementById('orderChart').getContext('2d');
            const orderChart = new Chart(orderCtx, {
                type: 'bar',
                data: {
                    labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
                    datasets: [{
                        label: '订单数量',
                        data: [12, 15, 10, 8, 14, 18, 22],
                        backgroundColor: 'rgba(59, 130, 246, 0.5)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                precision: 0
                            }
                        }
                    }
                }
            });
            
            // 成功率饼图
            const successCtx = document.getElementById('successRateChart').getContext('2d');
            const successChart = new Chart(successCtx, {
                type: 'doughnut',
                data: {
                    labels: ['成功', '失败', '取消'],
                    datasets: [{
                        data: [92, 5, 3],
                        backgroundColor: [
                            'rgba(16, 185, 129, 0.7)',
                            'rgba(239, 68, 68, 0.7)',
                            'rgba(245, 158, 11, 0.7)'
                        ],
                        borderColor: [
                            'rgba(16, 185, 129, 1)',
                            'rgba(239, 68, 68, 1)',
                            'rgba(245, 158, 11, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
            
            // 将图表实例存储到window对象中，方便后续更新
            window.charts = {
                orderChart: orderChart,
                successChart: successChart
            };
        }
        
        // 根据日期范围更新图表
        function updateChartsByDateRange(range) {
            showLoading();
            
            // 模拟API请求延迟
            setTimeout(() => {
                hideLoading();
                
                let orderData = [];
                let successData = [];
                let labels = [];
                
                // 根据不同的日期范围设置不同的数据
                switch(range) {
                    case 'today':
                        labels = ['9时', '10时', '11时', '12时', '13时', '14时', '15时', '16时', '17时'];
                        orderData = [2, 3, 4, 2, 1, 3, 5, 4, 2];
                        successData = [95, 3, 2];
                        break;
                    case 'week':
                        labels = ['周一', '周二', '周三', '周四', '周五', '周六', '周日'];
                        orderData = [12, 15, 10, 8, 14, 18, 22];
                        successData = [92, 5, 3];
                        break;
                    case 'month':
                        labels = ['第1周', '第2周', '第3周', '第4周'];
                        orderData = [45, 52, 48, 60];
                        successData = [90, 6, 4];
                        break;
                    case 'quarter':
                        labels = ['1月', '2月', '3月'];
                        orderData = [150, 180, 210];
                        successData = [88, 7, 5];
                        break;
                }
                
                // 更新订单图表
                window.charts.orderChart.data.labels = labels;
                window.charts.orderChart.data.datasets[0].data = orderData;
                window.charts.orderChart.update();
                
                // 更新成功率图表
                window.charts.successChart.data.datasets[0].data = successData;
                window.charts.successChart.update();
                
                // 更新收益概览的标题
                const dateRangeText = document.querySelector('.tech-badge');
                dateRangeText.textContent = document.getElementById('dateRange').options[document.getElementById('dateRange').selectedIndex].text;
                
            }, 800);
        }
    </script>
</body>
</html> 