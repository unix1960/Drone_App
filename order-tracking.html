<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>订单拍摄 - 合伙人管理系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#1E40AF',
                        accent: '#06B6D4',
                        dark: '#1E293B',
                        light: '#F8FAFC',
                        'gray-medium': '#64748B',
                        'gray-light': '#E2E8F0',
                        'blue-primary': '#3B82F6',
                        'blue-secondary': '#1D4ED8',
                        'status-success': '#10B981',
                        'status-warning': '#F59E0B',
                        'status-danger': '#EF4444',
                    },
                    fontFamily: {
                        inter: ['Inter', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            }
            .touch-friendly {
                touch-action: manipulation;
                -webkit-tap-highlight-color: transparent;
            }
            .safe-area-bottom {
                padding-bottom: constant(safe-area-inset-bottom);
                padding-bottom: env(safe-area-inset-bottom);
            }
            .miniprogram-card {
                box-shadow: 0 2px 8px rgba(0,0,0,0.06);
                border-radius: 8px;
            }
            .content-container {
                min-height: calc(100vh - 4rem);
                padding-bottom: calc(4rem + 1rem);
            }
            .drone-status-indicator {
                position: relative;
            }
            .drone-status-indicator::before {
                content: '';
                position: absolute;
                top: -2px;
                right: -2px;
                width: 12px;
                height: 12px;
                border-radius: 50%;
                background: #10B981;
                border: 2px solid white;
                animation: blink 1.5s infinite;
            }
            @keyframes blink {
                0%, 100% { opacity: 1; }
                50% { opacity: 0.3; }
            }
            .emergency-button {
                background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
                box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
                transform: scale(1);
                transition: all 0.3s ease;
            }
            .emergency-button:active {
                transform: scale(0.95);
                box-shadow: 0 5px 15px rgba(239, 68, 68, 0.4);
            }
            .progress-ring-circle {
                transition: stroke-dashoffset 0.35s;
                transform: rotate(-90deg);
                transform-origin: 50% 50%;
            }
            .hide-scrollbar {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            .hide-scrollbar::-webkit-scrollbar {
                display: none;
            }
            .card-hover {
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }
            .card-hover:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            }
            .btn-hover {
                transition: all 0.2s ease;
            }
            .btn-hover:hover {
                transform: translateY(-1px);
            }
            .btn-hover:active {
                transform: translateY(1px);
            }
            .toast-enter {
                animation: toastEnter 0.3s ease forwards;
            }
            .toast-exit {
                animation: toastExit 0.3s ease forwards;
            }
            @keyframes toastEnter {
                from { opacity: 0; transform: translate(-50%, 20px); }
                to { opacity: 1; transform: translate(-50%, 0); }
            }
            @keyframes toastExit {
                from { opacity: 1; transform: translate(-50%, 0); }
                to { opacity: 0; transform: translate(-50%, 20px); }
            }
        }
    </style>
</head>
<body class="font-inter bg-light text-dark antialiased touch-action-manipulation">
    <!-- 页面容器 -->
    <div class="content-container w-full safe-area-bottom">
        <!-- 头部导航 -->
        <header class="bg-white border-b border-gray-light sticky top-0 z-40 shadow-sm transition-all duration-300">
            <div class="flex items-center justify-between h-14 px-4">
                <div class="flex items-center">
                    <button onclick="history.back()" class="flex items-center text-gray-medium touch-friendly mr-3 btn-hover">
                        <i class="fa fa-angle-left text-xl"></i>
                    </button>
                    <div>
                        <h1 class="font-bold text-dark">订单拍摄</h1>
                        <div class="text-xs text-gray-medium">订单号: DX20230615001</div>
                    </div>
                </div>
                <div class="flex items-center">
                    <span class="text-status-success mr-2 flex items-center">
                        <span class="w-2 h-2 bg-status-success rounded-full mr-1"></span>在线
                    </span>
                    <div class="flex items-center">
                        <i class="fa fa-battery-three-quarters text-dark mr-1"></i>
                        <span class="text-dark">85%</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- 实时预览区域 -->
        <section class="relative mb-3 border-b border-gray-200 overflow-hidden">
            <img id="live-preview" src="https://picsum.photos/id/1018/800/450" alt="实时预览" class="w-full aspect-video object-cover transition-opacity duration-500">
            <div class="absolute top-3 left-3 px-3 py-1.5 bg-status-danger text-white text-xs rounded-full shadow-md transform transition-transform duration-300 hover:scale-105">
                <i class="fa fa-circle mr-1"></i>实时直播
            </div>
            <div class="absolute top-3 right-3 px-3 py-1.5 bg-black/50 text-white text-xs rounded-full shadow-md">
                <i class="fa fa-signal mr-1"></i>信号强度: 良好
            </div>
            <div class="absolute bottom-3 left-3 text-white text-xs bg-black/50 px-3 py-1.5 rounded-full shadow-md">
                <i class="fa fa-map-marker mr-1"></i>涌泉寺-全景拍摄-悬停等待..
            </div>
            <div class="absolute bottom-3 right-3 text-white text-xs bg-black/50 px-3 py-1.5 rounded-full shadow-md">
                <i class="fa fa-clock-o mr-1"></i>飞行时间: <span id="flight-time">05:25</span>
            </div>
        </section>

        <!-- 拍摄进度区域 -->
        <div class="mx-3 rounded-xl overflow-hidden shadow-sm mb-3 bg-white">
            <!-- 拍摄进度 -->
            <section class="p-4 bg-white border-b border-gray-100">
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center">
                        <h3 class="font-medium text-dark">拍摄进度</h3>
                    </div>
                    <div class="text-dark font-medium">2/5 景点</div>
                </div>
                
                <!-- 进度条 -->
                <div class="mb-4">
                    <div class="w-full bg-gray-100 rounded-full h-2.5 mb-2 overflow-hidden">
                        <div class="bg-primary h-2.5 rounded-full transition-all duration-1000 ease-out" style="width: 40%"></div>
                    </div>
                    
                    <!-- 景点完成状态指示器 -->
                    <div class="flex justify-between items-center">
                        <div class="flex flex-col items-center">
                            <div class="w-4 h-4 rounded-full bg-status-success flex items-center justify-center">
                                <i class="fa fa-check text-white text-xs"></i>
                            </div>
                            <span class="text-xs text-gray-medium mt-1">摩崖石刻</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-4 h-4 rounded-full bg-status-success flex items-center justify-center">
                                <i class="fa fa-check text-white text-xs"></i>
                            </div>
                            <span class="text-xs text-gray-medium mt-1">涌泉寺</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-4 h-4 rounded-full bg-primary flex items-center justify-center">
                                <span class="text-white text-xs">3</span>
                            </div>
                            <span class="text-xs text-gray-medium mt-1">登山古径</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-4 h-4 rounded-full bg-gray-300 flex items-center justify-center">
                                <span class="text-white text-xs">4</span>
                            </div>
                            <span class="text-xs text-gray-medium mt-1">屴崱峰</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-4 h-4 rounded-full bg-gray-300 flex items-center justify-center">
                                <span class="text-white text-xs">5</span>
                            </div>
                            <span class="text-xs text-gray-medium mt-1">回龙阁</span>
                        </div>
                    </div>
                </div>
                
                <!-- 当前拍摄信息 -->
                <div class="mb-4">
                    <!-- 景点卡片滚动区域 -->
                    <div class="relative">
                        <!-- 卡片滚动容器 -->
                        <div class="flex overflow-x-auto hide-scrollbar snap-x snap-mandatory pb-4" id="location-cards">
                            <!-- 摩崖石刻卡片 -->
                            <div class="flex-shrink-0 w-1/2 pr-1 snap-center">
                                <div class="bg-white rounded-lg overflow-hidden shadow-sm h-full card-hover">
                                    <div class="relative aspect-video">
                                        <img src="https://picsum.photos/id/29/400/200" alt="摩崖石刻" class="w-full h-full object-cover transition-transform duration-500 hover:scale-105">
                                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                                        <div class="absolute bottom-2 left-2 text-white">
                                            <div class="font-medium">摩崖石刻</div>
                                            <div class="text-xs flex items-center">
                                                <i class="fa fa-image mr-1"></i>样片: 4/4
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 涌泉寺卡片 -->
                            <div class="flex-shrink-0 w-1/2 px-1 snap-center">
                                <div class="bg-white rounded-lg overflow-hidden shadow-sm h-full card-hover">
                                    <div class="relative aspect-video">
                                        <img src="https://picsum.photos/id/28/400/200" alt="涌泉寺" class="w-full h-full object-cover transition-transform duration-500 hover:scale-105">
                                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                                        <div class="absolute bottom-2 left-2 text-white">
                                            <div class="font-medium">涌泉寺</div>
                                            <div class="text-xs flex items-center">
                                                <i class="fa fa-image mr-1"></i>样片: 2/2
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 登山古径卡片 -->
                            <div class="flex-shrink-0 w-1/2 px-1 snap-center">
                                <div class="bg-white rounded-lg overflow-hidden shadow-sm h-full border-2 border-primary card-hover">
                                    <div class="relative aspect-video">
                                        <img src="https://picsum.photos/id/27/400/200" alt="登山古径" class="w-full h-full object-cover transition-transform duration-500 hover:scale-105">
                                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                                        <div class="absolute bottom-2 left-2 text-white">
                                            <div class="font-medium">登山古径</div>
                                            <div class="text-xs flex items-center">
                                                <i class="fa fa-image mr-1"></i>样片: 0/1
                                            </div>
                                        </div>
                                        <div class="absolute top-2 right-2 bg-primary/90 text-white text-xs px-2 py-1 rounded-full">
                                            当前
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 屴崱峰卡片 -->
                            <div class="flex-shrink-0 w-1/2 px-1 snap-center">
                                <div class="bg-white rounded-lg overflow-hidden shadow-sm h-full card-hover">
                                    <div class="relative aspect-video">
                                        <img src="https://picsum.photos/id/26/400/200" alt="屴崱峰" class="w-full h-full object-cover transition-transform duration-500 hover:scale-105">
                                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                                        <div class="absolute bottom-2 left-2 text-white">
                                            <div class="font-medium">屴崱峰</div>
                                            <div class="text-xs flex items-center">
                                                <i class="fa fa-image mr-1"></i>样片: 0/2
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 回龙阁卡片 -->
                            <div class="flex-shrink-0 w-1/2 pl-1 snap-center">
                                <div class="bg-white rounded-lg overflow-hidden shadow-sm h-full card-hover">
                                    <div class="relative aspect-video">
                                        <img src="https://picsum.photos/id/25/400/200" alt="回龙阁" class="w-full h-full object-cover transition-transform duration-500 hover:scale-105">
                                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                                        <div class="absolute bottom-2 left-2 text-white">
                                            <div class="font-medium">回龙阁</div>
                                            <div class="text-xs flex items-center">
                                                <i class="fa fa-image mr-1"></i>样片: 0/1
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            
            <!-- 样片列表 -->
            <section class="bg-white">
                <div class="flex items-center justify-between mb-3 px-4 pt-4">
                    <h4 class="text-dark font-medium">样片列表</h4>

                </div>
                <div class="px-4 pb-4">
                    <div class="grid grid-cols-4 gap-2" id="samples-grid">
                        <!-- 摩崖石刻样片 -->
                        <div class="relative aspect-square rounded-md overflow-hidden shadow-sm transition-all duration-300 hover:shadow-md" data-location="摩崖石刻">
                            <img src="https://picsum.photos/id/10/200/200" alt="全景航拍" class="w-full h-full object-cover transition-transform duration-500 hover:scale-105">
                            <div class="absolute inset-0 bg-black/30 flex items-center justify-center">
                                <i class="fa fa-check text-primary text-xl"></i>
                            </div>
                            <div class="absolute bottom-0 inset-x-0 bg-black/50 py-1 text-center">
                                <span class="text-white text-xs">已确认</span>
                            </div>
                        </div>
                        
                        <div class="relative aspect-square rounded-md overflow-hidden shadow-sm transition-all duration-300 hover:shadow-md" data-location="摩崖石刻">
                            <img src="https://picsum.photos/id/15/200/200" alt="特写镜头" class="w-full h-full object-cover transition-transform duration-500 hover:scale-105">
                            <div class="absolute inset-0 bg-black/30 flex items-center justify-center">
                                <i class="fa fa-check text-white text-xl"></i>
                            </div>
                            <div class="absolute bottom-0 inset-x-0 bg-black/50 py-1 text-center">
                                <span class="text-white text-xs">已拍摄</span>
                            </div>
                        </div>
                        
                        <div class="relative aspect-square rounded-md overflow-hidden shadow-sm transition-all duration-300 hover:shadow-md" data-location="摩崖石刻">
                            <img src="https://picsum.photos/id/20/200/200" alt="延时摄影" class="w-full h-full object-cover transition-transform duration-500 hover:scale-105">
                            <div class="absolute inset-0 bg-primary/30 flex items-center justify-center">
                                <i class="fa fa-camera text-white text-xl"></i>
                            </div>
                            <div class="absolute bottom-0 inset-x-0 bg-primary/50 py-1 text-center">
                                <span class="text-white text-xs">拍摄中</span>
                            </div>
                        </div>
                        
                        <div class="relative aspect-square rounded-md overflow-hidden bg-gray-100 shadow-sm transition-all duration-300 hover:shadow-md" data-location="摩崖石刻">
                            <div class="absolute inset-0 flex items-center justify-center">
                                <i class="fa fa-clock-o text-gray-medium text-xl"></i>
                            </div>
                            <div class="absolute bottom-0 inset-x-0 bg-black/50 py-1 text-center">
                                <span class="text-white text-xs">待拍摄</span>
                            </div>
                        </div>

                        <!-- 涌泉寺样片 -->
                        <div class="relative aspect-square rounded-md overflow-hidden shadow-sm transition-all duration-300 hover:shadow-md hidden" data-location="涌泉寺">
                            <img src="https://picsum.photos/id/25/200/200" alt="涌泉寺全景" class="w-full h-full object-cover transition-transform duration-500 hover:scale-105">
                            <div class="absolute inset-0 bg-black/30 flex items-center justify-center">
                                <i class="fa fa-check text-white text-xl"></i>
                            </div>
                            <div class="absolute bottom-0 inset-x-0 bg-black/50 py-1 text-center">
                                <span class="text-white text-xs">已完成</span>
                            </div>
                        </div>
                        
                        <div class="relative aspect-square rounded-md overflow-hidden bg-gray-100 shadow-sm transition-all duration-300 hover:shadow-md hidden" data-location="涌泉寺">
                            <div class="absolute inset-0 flex items-center justify-center">
                                <i class="fa fa-clock-o text-gray-medium text-xl"></i>
                            </div>
                            <div class="absolute bottom-0 inset-x-0 bg-black/50 py-1 text-center">
                                <span class="text-white text-xs">待拍摄</span>
                            </div>
                        </div>
                        
                        <!-- 登山古径样片 -->
                        <div class="relative aspect-square rounded-md overflow-hidden bg-gray-100 shadow-sm transition-all duration-300 hover:shadow-md hidden" data-location="登山古径">
                            <div class="absolute inset-0 flex items-center justify-center">
                                <i class="fa fa-clock-o text-gray-medium text-xl"></i>
                            </div>
                            <div class="absolute bottom-0 inset-x-0 bg-black/50 py-1 text-center">
                                <span class="text-white text-xs">待拍摄</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- 控制按钮区域 -->
        <div class="mx-3 mt-4 mb-6">
            <!-- 两行两列布局 -->
            <div class="grid grid-cols-2 gap-3 mb-3">
                <!-- 返回起点按钮 -->
                <button id="returnStartBtn" class="bg-white text-gray-800 p-4 rounded-lg shadow-sm flex flex-col items-center justify-center touch-friendly btn-hover">
                    <i class="fa fa-home text-2xl mb-2 text-blue-500"></i>
                    <span>返回起点</span>
                </button>
                <!-- 继续拍摄按钮 -->
                <button id="togglePauseBtn" class="bg-white text-gray-800 p-4 rounded-lg shadow-sm flex flex-col items-center justify-center touch-friendly btn-hover">
                    <i class="fa fa-play text-2xl mb-2 text-green-500"></i>
                    <span>继续拍摄</span>
                </button>
                

            </div>
            
            <div class="grid grid-cols-2 gap-3 mb-3">
                <!-- 悬停等待按钮 -->
                <button id="hoverWaitBtn" class="bg-white text-gray-800 p-4 rounded-lg shadow-sm flex flex-col items-center justify-center touch-friendly btn-hover">
                    <i class="fa fa-hand-paper-o text-2xl mb-2 text-blue-500"></i>
                    <span>悬停等待</span>
                </button>
                
                <!-- 下一样片按钮 -->
                <button id="nextSampleBtn" class="bg-blue-500 text-white p-4 rounded-lg shadow-sm flex flex-col items-center justify-center touch-friendly btn-hover">
                    <i class="fa fa-play text-2xl mb-2"></i>
                    <span>下一样片</span>
                </button>
            </div>
            
            <!-- 完成拍摄按钮 - 全宽 -->
            <button id="completeMissionBtn" class="w-full bg-emerald-500 text-white p-5 rounded-lg shadow-sm flex items-center justify-center touch-friendly mb-3 btn-hover">
                <i class="fa fa-check text-xl mr-2"></i>
                <span class="text-lg">完成所有拍摄任务</span>
            </button>
            
            <!-- 客户联系按钮 -->
            <button class="w-full bg-blue-500 text-white p-4 rounded-lg shadow-sm flex justify-between items-center mb-3 transition-all duration-300 hover:shadow-md btn-hover" onclick="makePhoneCall('13812341234')">
                <div>
                    <h4 class="font-medium">客户联系</h4>
                    <p class="text-sm text-white/80">有问题及时沟通</p>
                </div>
                <div class="bg-white/30 px-5 py-2.5 rounded-lg flex items-center transition-all duration-300 hover:bg-white/40">
                    <i class="fa fa-phone mr-2"></i>
                    <span>拨打电话</span>
                </div>
            </button>
            
            <!-- 紧急停止按钮 -->
            <button id="emergencyStopBtn" class="w-full emergency-button text-white p-5 rounded-lg flex items-center justify-center touch-friendly">
                <i class="fa fa-stop text-xl mr-2"></i>
                <span class="text-lg font-medium">紧急停止</span>
            </button>
        </div>

        <!-- 紧急停止确认弹窗 -->
        <div id="emergencyStopModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 opacity-0 pointer-events-none transition-opacity duration-300">
            <div class="bg-white rounded-lg w-full max-w-md mx-4 overflow-hidden transform scale-95 transition-transform duration-300">
                <div class="p-5 border-b border-gray-light">
                    <h3 class="font-bold text-lg text-dark text-center">紧急停止确认</h3>
                </div>
                <div class="p-5">
                    <p class="text-center text-gray-medium mb-6">
                        确定要紧急停止并召回无人机吗？
                        <br>
                        <span class="text-status-danger font-medium">此操作将中断当前拍摄任务</span>
                    </p>
                    <div class="flex space-x-3">
                        <button id="cancelEmergencyBtn" class="flex-1 bg-gray-light text-gray-medium py-3 rounded-lg font-medium touch-friendly btn-hover">
                            取消
                        </button>
                        <button id="confirmEmergencyBtn" class="flex-1 bg-status-danger text-white py-3 rounded-lg font-medium touch-friendly btn-hover">
                            确认停止
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 视频预览模态框 -->
        <div id="videoPreviewModal" class="fixed inset-0 z-50 bg-black touch-friendly opacity-0 pointer-events-none transition-opacity duration-300">
            <!-- 顶部导航 -->
            <div class="absolute top-0 left-0 right-0 z-10 p-4 flex items-center justify-between">
                <button id="closePreviewBtn" class="text-white text-2xl btn-hover">
                    <i class="fa fa-times"></i>
                </button>
                <div class="text-white text-center">
                    <h3 class="font-medium" id="previewTitle">摩崖石刻（全景航拍）</h3>
                </div>
                <div class="text-white text-sm">
                    <span id="currentIndex">1</span> / <span id="totalCount">1</span>
                </div>
            </div>
            
            <!-- 视频播放器 -->
            <div class="h-full flex items-center justify-center">
                <div class="w-full px-4">
                    <div class="relative w-full">
                        <video id="previewVideo" class="w-full rounded-lg shadow-2xl" controls>
                            <source src="" type="video/mp4">
                            您的浏览器不支持视频播放
                        </video>
                    </div>
                </div>
            </div>
            
            <!-- 底部控制栏 -->
            <div class="absolute bottom-0 left-0 right-0 p-4 z-10">
                <div class="flex justify-between mb-4">
                    <div class="text-white">
                        <h4 id="sampleName" class="font-medium">精彩视频 1</h4>
                        <p class="text-xs opacity-80">视频 · 12分钟</p>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <button id="retakeBtn" class="bg-gray-700 text-white py-3 rounded-lg flex items-center justify-center touch-friendly btn-hover">
                        <i class="fa fa-refresh mr-2"></i>
                        重拍
                    </button>
                    <button id="approveBtn" class="bg-green-600 text-white py-3 rounded-lg flex items-center justify-center touch-friendly btn-hover">
                        <i class="fa fa-check mr-2"></i>
                        确认通过
                    </button>
                </div>
            </div>
            
            <!-- 左右滑动区域 -->
            <div class="absolute inset-y-0 left-0 w-16 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity" id="prevSampleBtn">
                <div class="w-10 h-10 bg-black/50 rounded-full flex items-center justify-center btn-hover">
                    <i class="fa fa-angle-left text-white text-2xl"></i>
                </div>
            </div>
            <div class="absolute inset-y-0 right-0 w-16 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity" id="nextSampleBtn">
                <div class="w-10 h-10 bg-black/50 rounded-full flex items-center justify-center btn-hover">
                    <i class="fa fa-angle-right text-white text-2xl"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript交互代码 -->
    <script>
        // 动态调整内容区域高度
        function adjustContentHeight() {
            const headerHeight = document.querySelector('header').offsetHeight;
            const contentContainer = document.querySelector('.content-container');
            if (contentContainer) {
                contentContainer.style.minHeight = `calc(100vh - ${headerHeight}px)`;
                contentContainer.style.paddingBottom = `calc(${headerHeight}px + 1rem)`;
            }
        }

        // 页面加载后调整高度
        window.addEventListener('load', adjustContentHeight);
        // 窗口大小改变时重新调整
        window.addEventListener('resize', adjustContentHeight);

        // 显示Toast提示
        function showToast(message) {
            // 先移除已有的toast
            const existingToast = document.querySelector('.toast');
            if (existingToast) {
                existingToast.remove();
            }
            
            // 创建Toast元素
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-black/70 text-white px-4 py-2 rounded-lg text-sm z-50 toast toast-enter';
            toast.textContent = message;
            
            // 添加到页面
            document.body.appendChild(toast);
            
            // 2秒后移除
            setTimeout(() => {
                toast.classList.remove('toast-enter');
                toast.classList.add('toast-exit');
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, 2000);
        }

        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            // 模拟实时数据更新
            simulateRealTimeUpdates();
            
            // 为样片缩略图添加点击事件
            initSampleThumbnails();
            
            // 初始化控制按钮
            initControlButtons();
            
            // 初始化所有按钮的点击声音反馈
            initButtonSoundEffects();
            
            // 初始化景点卡片滑动
            initLocationCards();
            
            // 初始化模态框动画
            initModalAnimations();
        });

        // 初始化样片缩略图点击事件
        function initSampleThumbnails() {
            const thumbnails = document.querySelectorAll('.grid-cols-4 > div');
            thumbnails.forEach(thumbnail => {
                thumbnail.addEventListener('click', function() {
                    // 待拍摄样片点击时显示确认对话框
                    if (this.querySelector('i.fa-clock-o')) {
                        if (confirm('是否开始拍摄此样片？')) {
                            // 更改为拍摄中状态
                            const icon = this.querySelector('i');
                            icon.classList.remove('fa-clock-o');
                            icon.classList.add('fa-camera');
                            icon.parentElement.classList.add('bg-primary/30');
                            
                            const statusBar = this.querySelector('.bottom-0');
                            statusBar.classList.remove('bg-black/50');
                            statusBar.classList.add('bg-primary/50');
                            
                            const statusText = statusBar.querySelector('span');
                            statusText.textContent = '拍摄中';
                            
                            showToast('开始拍摄样片');
                        }
                    } else {
                        // 已完成或拍摄中样片点击时预览
                        openVideoPreview(this);
                    }
                });
            });
            
            // 初始化视频预览模态框
            initVideoPreviewModal();
        }
        
        // 初始化视频预览模态框
        function initVideoPreviewModal() {
            const modal = document.getElementById('videoPreviewModal');
            if (!modal) return;
            
            const closeBtn = document.getElementById('closePreviewBtn');
            const prevBtn = document.getElementById('prevSampleBtn');
            const nextBtn = document.getElementById('nextSampleBtn');
            const retakeBtn = document.getElementById('retakeBtn');
            const approveBtn = document.getElementById('approveBtn');
            
            // 关闭按钮
            closeBtn.addEventListener('click', () => {
                hideModal(modal);
                document.getElementById('previewVideo').pause();
            });
            
            // 上一个样片
            prevBtn.addEventListener('click', () => {
                navigateSample('prev');
            });
            
            // 下一个样片
            nextBtn.addEventListener('click', () => {
                navigateSample('next');
            });
            
            // 重拍按钮
            retakeBtn.addEventListener('click', () => {
                if (confirm('确定要重新拍摄此样片吗？')) {
                    showToast('已安排重新拍摄');
                    hideModal(modal);
                }
            });
            
            // 确认通过按钮
            approveBtn.addEventListener('click', () => {
                showToast('样片已确认通过');
                
                // 更新当前预览的样片状态为"已确认"
                const currentSampleId = modal.getAttribute('data-current-sample');
                if (currentSampleId) {
                    const sample = document.getElementById(currentSampleId);
                    if (sample) {
                        const statusText = sample.querySelector('.bottom-0 span');
                        if (statusText && statusText.textContent === '已拍摄') {
                            statusText.textContent = '已确认';
                            
                            // 更改图标颜色为蓝色
                            const icon = sample.querySelector('i.fa-check');
                            if (icon) {
                                icon.classList.remove('text-white');
                                icon.classList.add('text-primary');
                            }
                        }
                    }
                }
                
                hideModal(modal);
            });
            
            // 添加触摸滑动支持
            let touchStartX = 0;
            let touchEndX = 0;
            
            modal.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
            }, { passive: true });
            
            modal.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            });
            
            function handleSwipe() {
                const swipeThreshold = 100;
                if (touchEndX < touchStartX - swipeThreshold) {
                    // 向左滑动，下一个样片
                    navigateSample('next');
                }
                if (touchEndX > touchStartX + swipeThreshold) {
                    // 向右滑动，上一个样片
                    navigateSample('prev');
                }
            }
        }
        
        // 打开视频预览
        function openVideoPreview(sampleElement) {
            const modal = document.getElementById('videoPreviewModal');
            const video = document.getElementById('previewVideo');
            const sampleName = document.getElementById('sampleName');
            const currentIndex = document.getElementById('currentIndex');
            const totalCount = document.getElementById('totalCount');
            
            if (!modal || !video) return;
            
            // 获取样片信息
            const imgSrc = sampleElement.querySelector('img')?.src || '';
            const sampleTitle = sampleElement.querySelector('img')?.alt || '样片预览';
            
            // 为样片元素添加ID，以便后续更新状态
            if (!sampleElement.id) {
                sampleElement.id = 'sample-' + Date.now();
            }
            modal.setAttribute('data-current-sample', sampleElement.id);
            
            // 设置视频源（这里使用示例视频）
            video.src = 'https://www.w3schools.com/html/mov_bbb.mp4';
            
            // 更新标题和计数
            sampleName.textContent = sampleTitle;
            
            // 获取所有可预览的样片（已完成或拍摄中）
            const previewableSamples = Array.from(document.querySelectorAll('.grid-cols-4 > div')).filter(
                sample => !sample.querySelector('i.fa-clock-o')
            );
            
            // 更新当前索引和总数
            const currentSampleIndex = previewableSamples.indexOf(sampleElement);
            currentIndex.textContent = (currentSampleIndex + 1).toString();
            totalCount.textContent = previewableSamples.length.toString();
            
            // 显示模态框
            showModal(modal);
            
            // 自动播放视频
            video.play().catch(e => console.log('自动播放失败:', e));
        }
        
        // 导航到上一个或下一个样片
        function navigateSample(direction) {
            const modal = document.getElementById('videoPreviewModal');
            const currentSampleId = modal.getAttribute('data-current-sample');
            if (!currentSampleId) return;
            
            const currentSample = document.getElementById(currentSampleId);
            if (!currentSample) return;
            
            // 获取所有可预览的样片
            const previewableSamples = Array.from(document.querySelectorAll('.grid-cols-4 > div')).filter(
                sample => !sample.querySelector('i.fa-clock-o')
            );
            
            const currentIndex = previewableSamples.indexOf(currentSample);
            let nextIndex;
            
            if (direction === 'next') {
                nextIndex = (currentIndex + 1) % previewableSamples.length;
            } else {
                nextIndex = (currentIndex - 1 + previewableSamples.length) % previewableSamples.length;
            }
            
            // 打开下一个样片的预览
            openVideoPreview(previewableSamples[nextIndex]);
        }
        
        // 初始化控制按钮
        function initControlButtons() {
            // 紧急停止按钮点击事件
            const emergencyStopBtn = document.getElementById('emergencyStopBtn');
            const emergencyStopModal = document.getElementById('emergencyStopModal');
            const cancelEmergencyBtn = document.getElementById('cancelEmergencyBtn');
            const confirmEmergencyBtn = document.getElementById('confirmEmergencyBtn');

            // 暂停/继续拍摄切换按钮
            const togglePauseBtn = document.getElementById('togglePauseBtn');
            let isPaused = true; // 默认显示继续拍摄

            if (togglePauseBtn) {
                togglePauseBtn.addEventListener('click', () => {
                    isPaused = !isPaused;
                    if (isPaused) {
                        // 切换为继续拍摄
                        togglePauseBtn.innerHTML = `
                            <i class="fa fa-play text-2xl mb-2 text-green-500"></i>
                            <span>继续拍摄</span>
                        `;
                        showToast('已暂停拍摄');
                    } else {
                        // 切换为暂停拍摄
                        togglePauseBtn.innerHTML = `
                            <i class="fa fa-pause text-2xl mb-2 text-yellow-500"></i>
                            <span>暂停拍摄</span>
                        `;
                        showToast('已继续拍摄');
                    }
                });
            }

            if (emergencyStopBtn) {
                emergencyStopBtn.addEventListener('click', () => {
                    showModal(emergencyStopModal);
                });
            }

            cancelEmergencyBtn.addEventListener('click', () => {
                hideModal(emergencyStopModal);
            });

            confirmEmergencyBtn.addEventListener('click', () => {
                hideModal(emergencyStopModal);
                showToast('无人机正在紧急返航');
                
                // 模拟无人机返航过程
                setTimeout(() => {
                    window.location.href = 'order.html';
                }, 3000);
            });

            // 点击弹窗外部关闭
            emergencyStopModal.addEventListener('click', (e) => {
                if (e.target === emergencyStopModal) {
                    hideModal(emergencyStopModal);
                }
            });

            // 返回起点按钮点击事件
            const returnStartBtn = document.getElementById('returnStartBtn');
            if (returnStartBtn) {
                returnStartBtn.addEventListener('click', () => {
                    showToast('指令已执行：返回起点');
                });
            }

            // 悬停等待按钮点击事件
            const hoverWaitBtn = document.getElementById('hoverWaitBtn');
            if (hoverWaitBtn) {
                hoverWaitBtn.addEventListener('click', () => {
                    showToast('指令已执行：悬停等待');
                });
            }

            // 下一样片按钮点击事件
            const nextSampleBtn = document.getElementById('nextSampleBtn');
            if (nextSampleBtn) {
                nextSampleBtn.addEventListener('click', () => {
                    showToast('指令已执行：前往下一样片拍摄点');
                });
            }

            // 完成所有拍摄任务按钮点击事件（带确认对话框）
            const completeMissionBtn = document.getElementById('completeMissionBtn');
            if (completeMissionBtn) {
                completeMissionBtn.addEventListener('click', () => {
                    if (confirm('确定要完成所有拍摄任务并返航吗？')) {
                        showToast('正在结束任务并返航');
                        // 模拟任务完成后的操作
                        setTimeout(() => {
                            window.location.href = 'order.html';
                        }, 3000);
                    }
                });
            }
        }

        // 初始化所有按钮的点击声音反馈
        function initButtonSoundEffects() {
            // 创建一个音频上下文
            let audioContext;
            
            // 函数：播放点击音效
            function playClickSound() {
                try {
                    // 如果音频上下文不存在，创建一个
                    if (!audioContext) {
                        audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    }
                    
                    // 如果音频上下文被暂停，恢复它
                    if (audioContext.state === 'suspended') {
                        audioContext.resume();
                    }
                    
                    // 创建振荡器和增益节点
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    // 连接节点
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    // 设置音频参数
                    oscillator.type = 'sine';
                    oscillator.frequency.value = 440; // 440Hz 是A4音高
                    gainNode.gain.value = 0.1;
                    
                    // 设置衰减
                    gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.2);
                    
                    // 播放音频
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.2);
                } catch (e) {
                    // 如果浏览器不支持Web Audio API，静默失败
                    console.log('无法播放点击音效:', e);
                }
            }
            
            // 为所有可点击的按钮添加点击音效
            const buttons = document.querySelectorAll('button, [class*="btn-hover"], [class*="touch-friendly"]');
            buttons.forEach(button => {
                // 检查是否已经有点击事件监听
                const hasClickListener = getEventListeners(button).click && getEventListeners(button).click.length > 0;
                
                if (hasClickListener) {
                    // 如果已经有点击事件监听，保存原始的事件处理函数
                    const originalListeners = getEventListeners(button).click;
                    
                    // 移除所有原始的点击事件监听
                    originalListeners.forEach(listener => {
                        button.removeEventListener('click', listener.listener);
                    });
                    
                    // 添加新的点击事件监听，先播放音效，然后调用原始的处理函数
                    button.addEventListener('click', function(e) {
                        playClickSound();
                        // 调用原始的事件处理函数
                        originalListeners.forEach(listener => {
                            if (listener.listener) {
                                listener.listener.call(this, e);
                            }
                        });
                    });
                } else {
                    // 如果没有点击事件监听，直接添加一个只播放音效的点击事件监听
                    button.addEventListener('click', playClickSound);
                }
            });
        }
        
        // 联系客户
        function makePhoneCall(phoneNumber) {
            showToast('正在拨打电话...');
            // 实际应用中应调用系统拨号功能
            console.log('Calling:', phoneNumber);
        }
        
        // 辅助函数：获取元素的事件监听器（用于Safari和其他现代浏览器）
        function getEventListeners(element) {
            if (element._eventListeners) {
                return element._eventListeners;
            }
            
            // 对于没有_eventListeners属性的浏览器，返回一个模拟对象
            return {
                click: []
            };
        }

        // 初始化景点卡片滑动
        function initLocationCards() {
            const locationCards = document.getElementById('location-cards');
            const samplesGrid = document.getElementById('samples-grid');
            
            if (!locationCards || !samplesGrid) return;
            
            // 为景点卡片添加点击事件
            const cards = locationCards.querySelectorAll('.flex-shrink-0');
            cards.forEach(card => {
                card.addEventListener('click', function() {
                    // 获取当前景点名称
                    const cardTitle = this.querySelector('.font-medium').textContent;
                    
                    // 移除所有卡片的高亮边框
                    cards.forEach(c => {
                        const cardDiv = c.querySelector('div');
                        cardDiv.classList.remove('border-2', 'border-primary');
                    });
                    
                    // 添加当前卡片的高亮边框
                    const cardDiv = this.querySelector('div');
                    cardDiv.classList.add('border-2', 'border-primary');
                    
                    // 更新样片列表
                    updateSamplesList(cardTitle);
                    
                    // 显示提示信息
                    showToast(`已切换到${cardTitle}`);
                });
            });
        }
        
        // 更新样片列表
        function updateSamplesList(locationName) {
            const samplesGrid = document.getElementById('samples-grid');
            if (!samplesGrid) return;
            
            // 获取所有样片
            const allSamples = samplesGrid.querySelectorAll('.relative');
            
            // 隐藏所有样片
            allSamples.forEach(sample => {
                sample.classList.add('hidden');
                // 添加淡出动画
                sample.style.opacity = '0';
                sample.style.transition = 'opacity 0.3s ease';
            });
            
            // 显示选中景点的样片
            const locationSamples = samplesGrid.querySelectorAll(`[data-location="${locationName}"]`);
            locationSamples.forEach((sample, index) => {
                // 错开时间显示，创建动画效果
                setTimeout(() => {
                    sample.classList.remove('hidden');
                    // 触发重排后设置opacity
                    setTimeout(() => {
                        sample.style.opacity = '1';
                    }, 10);
                }, index * 100);
            });
        }

        // 模拟实时数据更新
        function simulateRealTimeUpdates() {
            let flightTime = 5 * 60 + 25; // 05:25 in seconds
            
            const updateInterval = setInterval(() => {
                // 更新飞行时间
                flightTime += 1;
                const minutes = Math.floor(flightTime / 60).toString().padStart(2, '0');
                const seconds = (flightTime % 60).toString().padStart(2, '0');
                document.getElementById('flight-time').textContent = `${minutes}:${seconds}`;
                
            }, 1000);
            
            // 页面离开时清除定时器
            window.addEventListener('beforeunload', () => {
                clearInterval(updateInterval);
            });
        }
        
        // 初始化模态框动画
        function initModalAnimations() {
            // 可以在这里添加更多模态框的动画初始化代码
        }
        
        // 显示模态框
        function showModal(modal) {
            if (!modal) return;
            
            // 显示背景
            modal.classList.remove('opacity-0', 'pointer-events-none');
            
            // 显示内容
            const modalContent = modal.querySelector('div:not([class*="bg-black"])');
            if (modalContent) {
                setTimeout(() => {
                    modalContent.classList.remove('scale-95');
                    modalContent.classList.add('scale-100');
                }, 10);
            }
            
            // 禁止背景滚动
            document.body.style.overflow = 'hidden';
        }
        
        // 隐藏模态框
        function hideModal(modal) {
            if (!modal) return;
            
            // 隐藏内容
            const modalContent = modal.querySelector('div:not([class*="bg-black"])');
            if (modalContent) {
                modalContent.classList.remove('scale-100');
                modalContent.classList.add('scale-95');
            }
            
            // 隐藏背景
            setTimeout(() => {
                modal.classList.add('opacity-0', 'pointer-events-none');
                // 允许背景滚动
                document.body.style.overflow = '';
            }, 300);
        }
    </script>
</body>
</html>
